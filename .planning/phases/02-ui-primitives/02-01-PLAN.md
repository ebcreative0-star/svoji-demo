---
phase: 02-ui-primitives
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/lib/cn.ts
  - src/components/ui/Button.tsx
  - src/components/ui/Card.tsx
  - src/components/ui/Input.tsx
  - src/components/ui/Textarea.tsx
  - src/components/ui/Select.tsx
  - src/components/ui/Badge.tsx
  - src/components/ui/FormInput.tsx
  - src/components/ui/FormTextarea.tsx
  - src/components/ui/FormSelect.tsx
  - src/components/ui/index.ts
autonomous: true
requirements: [PRIM-01, PRIM-02, PRIM-03, PRIM-04]

must_haves:
  truths:
    - "Button renders in 4 variants (primary, secondary, ghost, danger) x 3 sizes (sm, md, lg) with correct visual styling"
    - "Button isLoading prop shows Loader2 spinner and disables the button"
    - "Button supports leadingIcon, trailingIcon, and icon-only mode with required aria-label"
    - "Card compound component renders Card, Card.Header, Card.Body, Card.Footer with consistent border/radius/shadow"
    - "Card interactive prop adds hover shadow lift and cursor pointer"
    - "Input, Textarea, Select render with label above, error/helperText below, and branded focus ring"
    - "Input error state shows red border and error message"
    - "FormInput, FormTextarea, FormSelect integrate with react-hook-form Controller"
    - "Badge renders in 5 semantic intents (success, warning, danger, info, neutral) x 2 sizes (sm, md) as pill shape"
    - "Badge dot prop shows a colored status indicator dot"
  artifacts:
    - path: "src/lib/cn.ts"
      provides: "cn() class utility"
      exports: ["cn"]
    - path: "src/components/ui/Button.tsx"
      provides: "Button component"
      exports: ["Button", "ButtonProps"]
    - path: "src/components/ui/Card.tsx"
      provides: "Compound Card component"
      exports: ["Card"]
    - path: "src/components/ui/Input.tsx"
      provides: "Base Input component"
      exports: ["Input", "InputProps"]
    - path: "src/components/ui/Textarea.tsx"
      provides: "Base Textarea component"
      exports: ["Textarea", "TextareaProps"]
    - path: "src/components/ui/Select.tsx"
      provides: "Base Select component"
      exports: ["Select", "SelectProps"]
    - path: "src/components/ui/Badge.tsx"
      provides: "Badge component"
      exports: ["Badge", "BadgeProps"]
    - path: "src/components/ui/FormInput.tsx"
      provides: "RHF Input wrapper"
      exports: ["FormInput"]
    - path: "src/components/ui/FormTextarea.tsx"
      provides: "RHF Textarea wrapper"
      exports: ["FormTextarea"]
    - path: "src/components/ui/FormSelect.tsx"
      provides: "RHF Select wrapper"
      exports: ["FormSelect"]
    - path: "src/components/ui/index.ts"
      provides: "Barrel export"
  key_links:
    - from: "src/components/ui/Button.tsx"
      to: "class-variance-authority"
      via: "cva variant definition"
      pattern: "import.*cva.*class-variance-authority"
    - from: "src/components/ui/FormInput.tsx"
      to: "react-hook-form"
      via: "Controller component"
      pattern: "import.*Controller.*react-hook-form"
    - from: "src/components/ui/index.ts"
      to: "all ui components"
      via: "barrel re-exports"
      pattern: "export.*from"
---

<objective>
Build all four UI primitive components (Button, Card, Input/Textarea/Select, Badge) plus RHF wrappers and the cn() utility. Install cva + clsx as supporting dependencies.

Purpose: Establish the typed component foundation that all surface redesign phases (4-7) depend on. After this plan, every button, card, form field, and status badge in the app has a typed component to migrate to.

Output: 12 new files in src/components/ui/ and src/lib/, ready for migration in plan 02.
</objective>

<execution_context>
@/Users/eb-vm/.claude/get-shit-done/workflows/execute-plan.md
@/Users/eb-vm/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-ui-primitives/02-CONTEXT.md
@.planning/phases/02-ui-primitives/02-RESEARCH.md
@src/app/globals.css
@src/lib/types.ts
@src/lib/checklist-generator.ts
</context>

<interfaces>
<!-- Design tokens from globals.css that components must reference -->
Key CSS variables (from @theme in globals.css):
- --color-primary, --color-primary-light, --color-primary-dark
- --color-secondary, --color-accent, --color-accent-rose, --color-accent-sage
- --color-text, --color-text-light
- --color-background, --color-white
- --color-border

<!-- RHF types the FormX wrappers need -->
From react-hook-form:
```typescript
import { Controller, type Control, type FieldValues, type Path } from 'react-hook-form';
```

<!-- Existing icon usage pattern -->
From lucide-react (already installed):
```typescript
import { Loader2 } from 'lucide-react';
```
</interfaces>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and create cn() utility</name>
  <files>package.json, src/lib/cn.ts</files>
  <action>
1. Install class-variance-authority and clsx:
   ```bash
   npm install class-variance-authority clsx
   ```

2. Create `src/lib/cn.ts`:
   ```typescript
   import { clsx, type ClassValue } from 'clsx';

   export function cn(...inputs: ClassValue[]) {
     return clsx(inputs);
   }
   ```
   Note: Do NOT add tailwind-merge. OKLCH @theme token classes don't produce merge conflicts. If conflicts emerge later, twMerge can be swapped in.

3. Verify: `npx tsc --noEmit src/lib/cn.ts` compiles clean.
  </action>
  <verify>
    <automated>cd /Users/eb-vm/Documents/claw/wedding-web/svoji && npx tsc --noEmit --strict src/lib/cn.ts 2>&1 | head -20</automated>
  </verify>
  <done>class-variance-authority and clsx in package.json dependencies. cn() exported from src/lib/cn.ts and type-checks clean.</done>
</task>

<task type="auto">
  <name>Task 2: Create Button, Card, Badge, Input/Textarea/Select, FormX wrappers, and barrel export</name>
  <files>
    src/components/ui/Button.tsx,
    src/components/ui/Card.tsx,
    src/components/ui/Badge.tsx,
    src/components/ui/Input.tsx,
    src/components/ui/Textarea.tsx,
    src/components/ui/Select.tsx,
    src/components/ui/FormInput.tsx,
    src/components/ui/FormTextarea.tsx,
    src/components/ui/FormSelect.tsx,
    src/components/ui/index.ts
  </files>
  <action>
Create all 10 files. Implementation details below. Use `cn()` from `@/lib/cn` everywhere (not raw clsx). All interactive components need `'use client'` directive. All forwardRef components need `.displayName`.

### Button.tsx
Per CONTEXT.md locked decisions:
- **Variants:** Primary (solid accent bg), Secondary (outlined with primary border), Ghost (text-only, transparent bg), Danger (red-600 solid)
- **Sizes:** sm (text-xs, px-3 py-1.5, min-h-[32px]), md (text-sm, px-5 py-2.5, min-h-[44px] -- meets 44px touch target), lg (text-base, px-7 py-3.5, min-h-[52px])
- **Icon support:** `leadingIcon?: ReactNode`, `trailingIcon?: ReactNode`. When `children` is absent, treat as icon-only and log console.warn if `aria-label` is missing (don't enforce via TS discriminated union -- too complex for Phase 2).
- **Loading:** `isLoading?: boolean` shows `<Loader2 className="w-4 h-4 animate-spin" />` and sets `disabled`.
- Use `cva()` for variant composition. Props interface extends `ButtonHTMLAttributes<HTMLButtonElement>` and `VariantProps<typeof buttonVariants>`.
- Use `forwardRef`. Set `Button.displayName = 'Button'`.
- Shape: `rounded-full` (pill shape matching premium aesthetic).
- Focus: `focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--color-primary)]`.
- Disabled: `disabled:opacity-50 disabled:cursor-not-allowed`.
- Base: `inline-flex items-center justify-center gap-2 font-medium transition-colors select-none`.
- Color mapping for variants:
  - primary: `bg-[var(--color-primary)] text-white hover:bg-[var(--color-primary-light)]`
  - secondary: `border border-[var(--color-primary)] text-[var(--color-primary)] hover:bg-[var(--color-primary)] hover:text-white`
  - ghost: `text-[var(--color-primary)] hover:bg-[var(--color-primary)]/10`
  - danger: `bg-red-600 text-white hover:bg-red-700`

Follow the exact pattern from 02-RESEARCH.md Pattern 1.

### Card.tsx
Per CONTEXT.md locked decisions:
- **Compound components:** Card (outer), Card.Header, Card.Body, Card.Footer via dot notation (static property assignment).
- **Props:** `padding?: 'default' | 'compact'` and `interactive?: boolean` on Card. CardBody also accepts `padding`.
- **Visual:** `bg-white border border-[var(--color-border)] rounded-xl shadow-sm`.
- **Interactive:** When true, adds `cursor-pointer hover:shadow-md transition-shadow`.
- **Card.Header:** `px-4 py-3 border-b border-[var(--color-border)]`.
- **Card.Body:** `p-4` (default) or `p-3` (compact).
- **Card.Footer:** `px-4 py-3 border-t border-[var(--color-border)]`.
- No `'use client'` needed (no state/events in Card itself). But add it anyway since `interactive` uses hover which works with CSS only -- actually no JS needed. Skip `'use client'` on Card.
- Do NOT use forwardRef on Card (not a form element). Use plain function components.

Follow 02-RESEARCH.md Pattern 2.

### Input.tsx
Per CONTEXT.md locked decisions:
- **Props:** extends `InputHTMLAttributes<HTMLInputElement>` plus `label?: string`, `error?: string`, `helperText?: string`.
- **Layout:** flex-col gap-1. Label above (text-sm font-medium text-[var(--color-text)]). Input in middle. Error or helperText below.
- **Input visual:** `w-full px-4 py-3 border rounded-lg text-sm transition-colors`.
- **Focus:** `focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent`.
- **Error state:** `border-red-500 focus:ring-red-500` on input + `text-xs text-red-600` error text below.
- **Normal state:** `border-[var(--color-border)] hover:border-[var(--color-text-light)]`.
- `'use client'`, forwardRef, displayName.
- Auto-generate `id` from label if not provided (for htmlFor linkage).

Follow 02-RESEARCH.md Pattern 3.

### Textarea.tsx
Same visual style as Input but using `<textarea>` element:
- Props: extends `TextareaHTMLAttributes<HTMLTextAreaElement>` plus `label?: string`, `error?: string`, `helperText?: string`.
- Same layout, focus, error patterns as Input.
- Add `min-h-[80px] resize-y` to textarea base classes.
- forwardRef, displayName, 'use client'.

### Select.tsx
Same visual style as Input but using `<select>` element:
- Props: extends `SelectHTMLAttributes<HTMLSelectElement>` plus `label?: string`, `error?: string`, `helperText?: string`, `options: Array<{ value: string; label: string }>` (or accept `children` for flexibility -- prefer `children` approach to match native select pattern).
- Actually, use children approach: consumers pass `<option>` elements as children. This matches RSVP.tsx existing pattern and is more flexible.
- Same layout, focus, error patterns as Input.
- Add `appearance-none` and a custom chevron via `bg-[url(...)]` or simply keep native appearance for now (simpler). Use native appearance -- keeps it simple for Phase 2.
- forwardRef, displayName, 'use client'.

### Badge.tsx
Per CONTEXT.md locked decisions:
- **Intents:** success (green-100/green-700), warning (amber-100/amber-700), danger (red-100/red-700), info (blue-100/blue-700), neutral (gray-100/gray-600).
- **Sizes:** sm (text-xs px-2 py-0.5) and md (text-sm px-2.5 py-1).
- **Shape:** rounded-full (pill).
- **Dot:** `dot?: boolean` renders a small colored circle before text. Dot color maps: success=green-500, warning=amber-500, danger=red-500, info=blue-500, neutral=gray-400.
- Use cva() for variant composition.
- Base: `inline-flex items-center gap-1.5 font-medium rounded-full`.
- No forwardRef needed (span, not interactive). Plain function component.
- `'use client'` not strictly needed but add it for consistency.

Follow 02-RESEARCH.md Pattern 4.

### FormInput.tsx, FormTextarea.tsx, FormSelect.tsx
RHF Controller wrappers:
- Generic over `T extends FieldValues`.
- Props: `name: Path<T>`, `control: Control<T>`, plus all base component props (Omit name from base).
- Renders Controller with render prop that spreads `field` and passes `fieldState.error?.message` as `error` prop.
- `'use client'` directive.

Follow 02-RESEARCH.md Pattern 3 (FormInput section).

### index.ts (barrel export)
```typescript
export { Button, type ButtonProps } from './Button';
export { Card } from './Card';
export { Input, type InputProps } from './Input';
export { Textarea, type TextareaProps } from './Textarea';
export { Select, type SelectProps } from './Select';
export { Badge, type BadgeProps } from './Badge';
export { FormInput } from './FormInput';
export { FormTextarea } from './FormTextarea';
export { FormSelect } from './FormSelect';
```
Note: Card sub-components (Card.Header etc.) come along with the Card import via dot notation. Do NOT try to export them separately.

### Important implementation notes:
- Use COMPLETE Tailwind class strings everywhere (never interpolate fragments like `bg-${color}-100`). Tailwind 4 purges dynamic classes.
- All CSS variable references use the format `var(--color-xxx)` wrapped in Tailwind arbitrary value syntax: `bg-[var(--color-primary)]`.
- Use `cn()` from `@/lib/cn` for all class composition (not raw clsx).
  </action>
  <verify>
    <automated>cd /Users/eb-vm/Documents/claw/wedding-web/svoji && npx tsc --noEmit 2>&1 | head -30</automated>
  </verify>
  <done>
All 10 component files exist in src/components/ui/. TypeScript compilation passes with no errors. Each component:
- Button: 4 variants, 3 sizes, isLoading, leadingIcon, trailingIcon, forwardRef
- Card: compound (Card.Header, Card.Body, Card.Footer), padding tiers, interactive prop
- Input/Textarea/Select: label, error, helperText, forwardRef, branded focus ring
- Badge: 5 intents, 2 sizes, dot indicator
- FormInput/FormTextarea/FormSelect: RHF Controller wrappers
- index.ts: barrel exports all components
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` -- zero TypeScript errors across entire project
2. `npm run build` -- Next.js build succeeds (components are tree-shakeable, no side effects)
3. Spot check: import `{ Button, Card, Input, Badge }` from `@/components/ui` in any page file and verify autocomplete works
</verification>

<success_criteria>
- All 12 files created (cn.ts + 10 component files + package.json updated)
- Zero TypeScript compilation errors
- cva and clsx installed in package.json
- Every component uses design tokens from @theme (no hardcoded hex colors)
- Button has 4 variants x 3 sizes with isLoading and icon support
- Card has compound dot-notation sub-components
- Input/Textarea/Select have label, error, helperText props with consistent visual style
- Badge has 5 semantic intents with optional dot indicator
- FormX wrappers integrate with react-hook-form Controller
- Barrel index.ts exports everything
</success_criteria>

<output>
After completion, create `.planning/phases/02-ui-primitives/02-01-SUMMARY.md`
</output>
